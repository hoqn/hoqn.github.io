---
title: 안드로이드 6(M) 이하에서 한글을 포함한 URL이 제대로 작동되지 않는 문제
toc: true
date: 2021-07-21 00:00:00
categories:
- 개발
- 학교플러스
- 노트
tags:
- 학교플러스
- Android
---

## 문제점

안드로이드 6 이하 기기에서 학교 선택 시 학교 이름이나 종류(초등학교, 중학교...) 필터링 시 목록에 항상 0개만 노출되는 문제가 보고되었다. ~~최종 업데이트한 지 3개월이 넘게 몰랐다.~~

## 예상

Neis API 상에서 지역(관할 교육청) 코드는 `P10`, `E10` 등과 같이 기본 로마자와 숫자로만 이루어져 있다. 반면, 학교 이름이나 종류는 오직 한글로만 이루어져 있다.

그래서 안드로이드 버전에 따라 다르고, 지역 필터링은 작동하는 것을 보아 한글 인코딩 문제가 아닌가 생각했다.

## 해결

디버깅을 하다보니, 역시나 인코딩 문제가 맞았다. (~~이걸 3개월 넘게 몰랐다는 건 엄청난 잘못이다.~~)

해결방안으로는 API를 요청하기 전에 URL String에  `URLEncoder.encode (String s, String enc)`를 사용하면 된다.
(특별하게 다른 의도가 없다면 `enc`는 `UTF-8`로 하면 된다.)

(아마 안드로이드 6 이전엔 안드로이드 내부 인코딩이 UTF-8가 아니었기 때문에 발생한 것 같다. 자세한 건 이후에 찾아보려고 한다.)





안드로이드 6(마시멜로) 이하에서 학교 검색이 되지 않는 점 확인되었고, 해당 부분이 해결된 0.3.2a 버전이 업데이트 되었습니다. 수고스러우시겠지만 업데이트 후 한 번 더 시도해주시면 감사하겠습니다. 이용에 불편을 드려서 죄송합니다. 😥
